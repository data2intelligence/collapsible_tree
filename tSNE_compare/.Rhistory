set.seed(123)
library(dplyr)
library(Seurat)
install.packages("igraph")
install.packages("igraph", type="binary")
set.seed(123)
library(dplyr)
library(Seurat)
install.packages("deldir")
set.seed(123)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
setwd("/Users/_alanglanglang/Desktop/PhD-Lab/Cell.lineage.pilot/Web-Interface/tSNE_compare")
set.seed(123)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
setwd("/Users/_alanglanglang/Desktop/PhD-Lab/Cell.lineage.pilot/lineage_visualization/tSNE_compare")
set.seed(123)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
setwd("/Users/_alanglanglang/Desktop/PhD-Lab/Cell.lineage.pilot/lineage_visualization/tSNE_compare")
set.seed(123)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
setwd("/Users/_alanglanglang/Desktop/PhD-Lab/Cell.lineage.pilot/lineage_visualization/tSNE_compare")
getwd()
set.seed(123)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
# setwd("/Users/ygao61/Desktop/PhD-Lab/Cell.lineage.pilot/lineage_visualization/tSNE_compare")
getwd()
scePath = "../../sce/E-MTAB-6149_NSCLC"
load(paste0(scePath,"_TPM.rda"))
load(paste0(scePath,"_meta.rda"))
### all
sc.matrix.anno.sub <- as.matrix(sc.matrix.anno[!sc.matrix.anno[,"uniformCellTypeSub"]%in%c("Malignant",NA),])
sc.matrix.data.sub <- sc.matrix.data[,rownames(sc.matrix.anno.sub)]
mtx.data <- CreateSeuratObject(counts = sc.matrix.data.sub, project = "sce")
set.seed(123)
library(dplyr)
library(Seurat)
library(patchwork)
library(ggplot2)
# setwd("/Users/ygao61/Desktop/PhD-Lab/Cell.lineage.pilot/lineage_visualization/tSNE_compare")
getwd()
scePath = "../../sce/E-MTAB-6149_NSCLC"
load(paste0(scePath,"_TPM.rda"))
load(paste0(scePath,"_meta.rda"))
### all
sc.matrix.anno.sub <- as.matrix(sc.matrix.anno[!sc.matrix.anno[,"uniformCellTypeSub"]%in%c("Malignant",NA),])
sc.matrix.data.sub <- sc.matrix.data[,rownames(sc.matrix.anno.sub)]
mtx.data <- CreateSeuratObject(counts = sc.matrix.data.sub, project = "sce")
mtx.data <- NormalizeData(mtx.data, normalization.method = "LogNormalize", scale.factor = 10000)
# ??? diff pre-process in tSNE and UMAP
# ## variance normalize, identify overdispersed genes
# matnorm.info <- normalizeVariance(sc.matrix.data.sub,details=TRUE,verbose=FALSE,alpha=0.05)
#
# ## log transform
# matnorm <- log10(matnorm.info$mat+1)
# feature selection
mtx.data <- FindVariableFeatures(mtx.data, selection.method = "vst", nfeatures = 2000)
# scaling the data
all.genes <- rownames(mtx.data)
mtx.data <- ScaleData(mtx.data, features = all.genes)
mtx.data <- ScaleData(mtx.data, features = all.genes)
